Host: SimCorp Web App Event Log Analysis

Query Used:

(index="main" host="10.0.0.175"
This initial query is very broad and searching for suspicious activitiy in the SimCorp Web App (10.0.0.175):
index="main" host="ip-10-0-0-175"

Screenshot Initial Query.png

The query returns over 40,000 events so further refinement is needed.  The search was narrowed down with a source path where "/var/log/apache2/access.log" has clearly had the bulk of events:



So the investigation continued with this query:
index="main" host="ip-10-0-0-175" source="/var/log/apache2/access.log"

This was the result:

PLACEHOLDER

These first 3 logs are suspicious and they are a good representative of all in this category.

The first log entry shows an attempt to access the /etc/passwd file using a URL encoding technique which could be indicative of an SQL injection attack.
Request: GET /cgi-bin/.%32%65/.%32%65/.%32%65/.%32%65/etc/passwd
Status Code: 400 (Bad Request)
User-Agent: iPad, Mac OS X
Suspicious Aspect: The request is attempting to access /etc/passwd, which is a sensitive system file in Unix-like systems. The use of encoded characters (%32%65) indicates an attempt to bypass security filters.

The second log entry is also suspicious.
Request: \x16\x03\x03\x01\x02
Status Code: 400 (Bad Request)
User-Agent: None
Suspicious Aspect: This entry shows a binary request (likely an SSL/TLS handshake attempt) sent to a web server port, which is unusual if itâ€™s not an HTTPS server. 
This could indicate a port scanning or a probing attempt.

The third log entry is an attempt to find other weaknesses and is enough to continue the search.
Request: GET /simcorp/login.php
Status Code: 200 (OK)
User-Agent: Windows NT, Chrome
Suspicious Aspect: Access to a login page (/simcorp/login.php). While this by itself is not suspicious, in the context of the other entries, it could indicate an attempt to find login portals for potential attacks.

The investigation went back to source and continued down the line to 


4672: Windows Account Lockout Event

Query Used:

(index="main" host="RISK-ANALYST1" (EventCode=4624 OR EventCode=4672 OR EventCode=4688)) EventCode=4672
Screenshot 2024-07-03 010113

Event Type: Special privilege assignment
The SYSTEM account has been granted several system-level privileges, including:
SeAssignPrimaryTokenPrivilege: Assigning primary tokens
SeTcbPrivilege: Accessing TCB (Trusted Computing Base) data
SeSecurityPrivilege: Performing security-related actions
SeTakeOwnershipPrivilege: Taking ownership of files and folders
SeLoadDriverPrivilege: Loading drivers
SeBackupPrivilege: Backing up files
SeRestorePrivilege: Restoring files
SeDebugPrivilege: Debugging processes
SeAuditPrivilege: Auditing processes
SeSystemEnvironmentPrivilege: Impersonating other users
These privileges allow the SYSTEM account to perform various system-level operations. You can view the full-text file for Event Code 4672 here.
